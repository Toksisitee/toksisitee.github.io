"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[618],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return k}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=p(a),k=r,h=u["".concat(s,".").concat(k)]||u[k]||d[k]||i;return a?n.createElement(h,l(l({ref:t},m),{},{components:a})):n.createElement(h,l({ref:t},m))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},502:function(e,t,a){a.r(t),a.d(t,{contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return m}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),l=["components"],o={sidebar_position:1},s="Events",p={unversionedId:"mv-api/mv-events",id:"mv-api/mv-events",title:"Events",description:"Multiverse has plenty of registerd callbacks that are executed when a specific event is triggered. To start receiving events, you first have to define the event's corresponding callback function inside your Lua script. You may expect parameters to be passed back to you, some of which are passed by reference.",source:"@site/docs/mv-api/mv-events.md",sourceDirName:"mv-api",slug:"/mv-api/mv-events",permalink:"/docs/mv-api/mv-events",editUrl:"https://github.com/Toksisitee/docs/mv-api/mv-events.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Functions",permalink:"/docs/mv-api/mv-functions"},next:{title:"Enums",permalink:"/docs/mv-api/mv-enums"}},m=[{value:"<ins>Essential</ins> \u2728",id:"essential-",children:[{value:"OnScript",id:"onscript",children:[],level:3},{value:"OnTurn",id:"onturn",children:[],level:3},{value:"OnThing",id:"onthing",children:[],level:3},{value:"OnRegenerate",id:"onregenerate",children:[],level:3}],level:2},{value:"<ins>Input</ins> \u2728",id:"input-",children:[{value:"OnKeyDown",id:"onkeydown",children:[],level:3},{value:"OnKeyUp",id:"onkeyup",children:[],level:3},{value:"OnMouse",id:"onmouse",children:[],level:3},{value:"OnChat",id:"onchat",children:[],level:3}],level:2},{value:"<ins>Serialization</ins> \u2728",id:"serialization-",children:[{value:"OnSave",id:"onsave",children:[],level:3},{value:"OnLoad",id:"onload",children:[],level:3}],level:2},{value:"<ins>Sound</ins> \u2728",id:"sound-",children:[{value:"OnSoundPlay",id:"onsoundplay",children:[],level:3},{value:"OnSoundStop",id:"onsoundstop",children:[],level:3}],level:2},{value:"<ins>Drawing</ins> \u2728",id:"drawing-",children:[{value:"OnFrame",id:"onframe",children:[],level:3},{value:"OnSpriteFrame",id:"onspriteframe",children:[],level:3},{value:"OnAnimSpriteFrame",id:"onanimspriteframe",children:[],level:3}],level:2},{value:"<ins>Other</ins> \u2728",id:"other-",children:[{value:"OnPlayerHintDisplay",id:"onplayerhintdisplay",children:[],level:3},{value:"OnPlayerSpell",id:"onplayerspell",children:[],level:3},{value:"OnDamage",id:"ondamage",children:[],level:3},{value:"OnDeinit",id:"ondeinit",children:[],level:3},{value:"OnLoadPalTables",id:"onloadpaltables",children:[],level:3},{value:"OnFrontEnd",id:"onfrontend",children:[],level:3},{value:"OnFrameCredits",id:"onframecredits",children:[],level:3},{value:"OnFrontEndFrame",id:"onfrontendframe",children:[],level:3}],level:2}],d={toc:m};function u(e){var t=e.components,o=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"events"},"Events"),(0,i.kt)("p",null,"Multiverse has plenty of registerd callbacks that are executed when a specific event is triggered. To start receiving events, you first have to define the event's corresponding callback function inside your Lua script. You may expect parameters to be passed back to you, some of which are passed by reference."),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"You may not have multiple definitions of the same callback, even if the second definition is located inside a secondary (",(0,i.kt)("inlineCode",{parentName:"p"},"require"),") script file or module. View the example below, where only ",(0,i.kt)("strong",{parentName:"p"},"one")," ",(0,i.kt)("inlineCode",{parentName:"p"},"OnTurn")," event will work."),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="Scripts/script.lua"',title:'"Scripts/script.lua"'},"module = require(get_script_dir() .. 'module.lua')\nfunction OnTurn() end\n")),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:'title="Scripts/module.lua"',title:'"Scripts/module.lua"'},"local module = {}\nfunction OnTurn() end\nreturn module\n")))),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"essential-"},(0,i.kt)("ins",null,"Essential")," \u2728"),(0,i.kt)("h3",{id:"onscript"},"OnScript"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\n",(0,i.kt)("inlineCode",{parentName:"p"},"OnScript")," is a crucial event and is generally always found inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"main.lua")," script, which is considered the ",(0,i.kt)("inlineCode",{parentName:"p"},"Parent"),". This event is triggered when scripts are supposed to be loaded, e.g. level restart, load, etc."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#ubyte"},"UBYTE"))),(0,i.kt)("td",{parentName:"tr",align:null},"level"),(0,i.kt)("td",{parentName:"tr",align:null},"The current level being loaded by the user.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=main.lua",title:"main.lua"},'function OnScript(level)\n    if (level == 1) then\n        AddScript("level_1.lua")\n    else\n        AddScript("level_2.lua")\n    end\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onturn"},"OnTurn"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event is triggered every time a game turn has passed. No parameters are being passed to this callback. To fetch the current game turn, use the example below."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters"),"\nNone."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Use the reserved ",(0,i.kt)("inlineCode",{parentName:"p"},"Game")," object to call the ",(0,i.kt)("inlineCode",{parentName:"p"},"getTurn")," method to get the current turn, or alternatively, the method ",(0,i.kt)("inlineCode",{parentName:"p"},"getTurnSecond"),", depending on the units you want to work with. Do note that one second is equal to 12 game turns!"))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"When using ",(0,i.kt)("inlineCode",{parentName:"p"},"getTurnSecond"),", it's advisable to check for a valid value. If the turn has already been processed, it will return an ",(0,i.kt)("inlineCode",{parentName:"p"},"ULONG_MAX")," (0xffffffff). However, ",(0,i.kt)("inlineCode",{parentName:"p"},"getTurn")," does not require this check."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnTurn()\n    local turn = Game.getTurnSecond()\n    \n    -- We ensure we only process the turn once.\n    if (turn ~= ULONG_MAX) then\n        Log(string.format("Current turn: %i", turn))\n    end\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onthing"},"OnThing"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event is triggered every time a game object is created, but ",(0,i.kt)("strong",{parentName:"p"},"only")," for objects created ",(0,i.kt)("strong",{parentName:"p"},"after")," the first game turn (anything above GT 0)."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#thing"},"Thing*"))),(0,i.kt)("td",{parentName:"tr",align:null},"thing"),(0,i.kt)("td",{parentName:"tr",align:null},"The thing object.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The thing object is passed by reference, so you may modify the object inside the callback function."))),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"If you're only interested in parsing spells, ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"#onplayerspell"},"OnPlayerSpell"))," will be a better alternative to ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"#onthing"},"OnThing")),", since you won't be having to parse hundreds of objects."))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Seralized objects that spawn during the first game turn (i.e. placed through the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/Toksisitee/ALACNPopWorldEditor"},"World Editor")),") will never trigger this event. This is intentional but might change in the future."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnThing(thing)\n    Log(string.format("[OnThing] Type: %i, Model: %i, Owner: %i", thing.Type, thing.Model, thing.Owner))\n    thing.Owner = thing.Owner + 1\n    if (thing.Owner > TRIBE_GREEN) then thing.Owner = TRIBE_BLUE end\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onregenerate"},"OnRegenerate"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when a level is loaded for the first time, or during an on-going level that is restarted."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#ubyte"},"UBYTE"))),(0,i.kt)("td",{parentName:"tr",align:null},"level"),(0,i.kt)("td",{parentName:"tr",align:null},"The current level the user is playing.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This event will ",(0,i.kt)("strong",{parentName:"p"},"not")," trigger when the user loads a game save file of the level, as it has already been generated before."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},"function OnRegenerate(level)\n    initialize_my_important_stuff()\nend\n")),(0,i.kt)("hr",null),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"input-"},(0,i.kt)("ins",null,"Input")," \u2728"),(0,i.kt)("h3",{id:"onkeydown"},"OnKeyDown"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when a key is pressed, the passed argument being the key code that was pressed."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-enums#tbinputkey"},"TbInputKey"))),(0,i.kt)("td",{parentName:"tr",align:null},"key"),(0,i.kt)("td",{parentName:"tr",align:null},"Key code that was pressed.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Return"),"\nIt is expected of you to return a ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#bool"},"boolean")),", indicating whether you want the game to handle the key event. Returning a ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," value will tell the input system to ",(0,i.kt)("strong",{parentName:"p"},"not")," handle the keystroke."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Not all keys trigger this event \u2013 for a full list of possible key codes check the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-enums#tbinputkey"},"TbInputKey"))," data structure."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},"function OnKeyDown(key)\n    if (key == TbInputKey.LB_KEY_Q) then\n        Log(\"'Q' key down!)\n    end\nend\n")),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onkeyup"},"OnKeyUp"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when a key is released, the passed argument being the key code that was released."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-enums#tbinputkey"},"TbInputKey"))),(0,i.kt)("td",{parentName:"tr",align:null},"key"),(0,i.kt)("td",{parentName:"tr",align:null},"Key code that was released.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Not all keys trigger this event \u2013 for a full list of possible key codes check the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-enums#tbinputkey"},"TbInputKey"))," data structure."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},"function OnKeyUp(key)\n    if (key == TbInputKey.LB_KEY_Q) then\n        Log(\"'Q' key released!)\n    end\nend\n")),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onmouse"},"OnMouse"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when a mouse button is pressed, the passed argument being a ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#mouseevent"},"MouseEvent")),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#mouseevent"},"MouseEvent"))),(0,i.kt)("td",{parentName:"tr",align:null},"event"),(0,i.kt)("td",{parentName:"tr",align:null},"Mouse event containing the button type and state, as well as the click location in screen space.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Return"),"\nIt is expected of you to return a ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#bool"},"boolean")),", indicating whether you want the game to handle the click event or not. Returning a ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," value will tell the input system to ",(0,i.kt)("strong",{parentName:"p"},"not")," handle the click. This is useful for cases where you want to create your own scripted GUI and consume the click events yourself."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The event will fire even whilst inside the main game menu or during a game pause."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnMouse(event)\n    if (event.Button == TbInputKey.LB_KEY_MOUSE0 and event.Down == true) then\n        Log(string.format("Left mouse button click at screen pos: %i, %i", e.Pos.X, e.Pos.Y))\n    end\nend\n')),(0,i.kt)("h3",{id:"onchat"},"OnChat"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when a message is sent using the ",(0,i.kt)("strong",{parentName:"p"},"TAB + F11")," chatbox, the passed argument being the message sent."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#std::string"},"string"))),(0,i.kt)("td",{parentName:"tr",align:null},"message"),(0,i.kt)("td",{parentName:"tr",align:null},"Message sent by the user.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnChat(message)\n    if (message == "/surrender") then\n        Log("I surrender!")\n    end\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"serialization-"},(0,i.kt)("ins",null,"Serialization")," \u2728"),(0,i.kt)("h3",{id:"onsave"},"OnSave"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when the user saves the game. You may use this event to save the state of your variables."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#slong"},"SLONG"))),(0,i.kt)("td",{parentName:"tr",align:null},"slot"),(0,i.kt)("td",{parentName:"tr",align:null},"This is the save slot chosen by the user.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"You can either save individual variables or tables containing one or more elements."))),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Saving will fail on local objects \u2013 ensure they're global before attempting to do so. To create a global table, simply declare it outside the scope of a function \u2013 there's no ",(0,i.kt)("inlineCode",{parentName:"p"},"global")," keyword."),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-lua"},'function my_function()\n    local MyCoolTable = { error="this table is only \'visible\' in this function block!" }\nend\n...\nSaveTable("MyCoolTable", slot) -- error, cannot find this table defined anywhere!\n')))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'MyTable = { Foo=0, Bar=1 }\nMySecondTable = {nil, 42, Foo=1, Bar=function() Log("Bar") end}\n\nfunction OnSave(slot)\n    SaveTable("MyTable", slot)\n    SaveTable("MySecondTable", slot)\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onload"},"OnLoad"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when the user loads a game save file. You may use this event to load the previous state of your variables."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#slong"},"SLONG"))),(0,i.kt)("td",{parentName:"tr",align:null},"slot"),(0,i.kt)("td",{parentName:"tr",align:null},"This is the save slot chosen by the user.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},"-- Based on the OnSave code example above,\n-- 'MyTable' and 'MySecondTable' were previously serialized.\n\nfunction OnLoad(slot)\n    LoadTable(\"MyTable\", slot)\n    LoadTable(\"MySecondTable\", slot)\nend\n")),(0,i.kt)("hr",null),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"sound-"},(0,i.kt)("ins",null,"Sound")," \u2728"),(0,i.kt)("h3",{id:"onsoundplay"},"OnSoundPlay"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Description:"),"\nThis event will trigger when a sound from the custom music engine starts playing."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#std::string"},"string"))),(0,i.kt)("td",{parentName:"tr",align:null},"name"),(0,i.kt)("td",{parentName:"tr",align:null},"This is the name of the playing sound file.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnSoundPlay(name)\n    Log(string.format("Now playing: %s", name))\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onsoundstop"},"OnSoundStop"),(0,i.kt)("p",null,"This event will trigger when a sound from the custom music engine stops playing."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#soundreceiverinfo"},"SoundReceiverInfo"))),(0,i.kt)("td",{parentName:"tr",align:null},"sri"),(0,i.kt)("td",{parentName:"tr",align:null},"This is a data structure containing the sound name and the reason it stopped playing.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Trying to play a custom music track from within this function will result in a crash, instead call the play method somewhere else, i.e inside OnTurn."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnSoundStop(sri)\n    Log(string.format("Stopped playing: %s, reason: %i", sri.FileName, sri.Reason))\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"drawing-"},(0,i.kt)("ins",null,"Drawing")," \u2728"),(0,i.kt)("h3",{id:"onframe"},"OnFrame"),(0,i.kt)("p",null,"This event will trigger every time a frame has finished rendering \u2013 essential for drawing text, sprites or shapes to the screen space. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters"),"\nNone."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Get and cache a reference to the object ",(0,i.kt)("inlineCode",{parentName:"p"},"gnsi")," to get the current screen width and height. You will most certainly need this for drawing inside ",(0,i.kt)("inlineCode",{parentName:"p"},"OnFrame"),"!"),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-lua"},"_gnsi = gnsi() -- global variable and called only once\n...\nlocal scrW, scrH = _gnsi.ScreenW, _gnsi.ScreenH\n")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnFrame()\n    local scrW, scrH = _gnsi.ScreenW, _gnsi.ScreenH\n    local x, y = math.floor(scrW / 2), math.floor(scrH / 2)\n    DrawBox(x, y, 220, 30, 0)\n    PopSetFont(P3_V_LARGE_FONT, 0)\n    DrawTextStr(x, y, "Hello from Lua!")\nend\n\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onspriteframe"},"OnSpriteFrame"),(0,i.kt)("p",null,"This event will trigger every ",(0,i.kt)("em",{parentName:"p"},"after")," the engine draws a sprite to the screen. It does not receive events from GUI drawing."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#spriteframeevent"},"SpriteFrameEvent*"))),(0,i.kt)("td",{parentName:"tr",align:null},"frame"),(0,i.kt)("td",{parentName:"tr",align:null},"This is a data structure containing information about the sprite frame that has just been rendered.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This event is useful for drawing your own text, sprites or shapes in world space, but introduces quite a bit of overhead."))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"There's a possibility for the frame to contain a non T_PERSON object, as a result of a few unique objects being rendered through this pipeline."))),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The structure ",(0,i.kt)("inlineCode",{parentName:"p"},"SpriteFrameEvent")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"OnSpriteFrame")," event is subject to heavy API changes in future Multiverse updates."))),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onanimspriteframe"},"OnAnimSpriteFrame"),(0,i.kt)("p",null,"This event will trigger every ",(0,i.kt)("em",{parentName:"p"},"after")," the engine draws a person sprite to the screen."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#spriteframeevent"},"SpriteFrameEvent*"))),(0,i.kt)("td",{parentName:"tr",align:null},"frame"),(0,i.kt)("td",{parentName:"tr",align:null},"This is a data structure containing information about the sprite frame that has just been rendered.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This event is useful for drawing your own text, sprites or shapes in world space, but introduces quite a bit of overhead."))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"There's a possibility for the frame to contain a non T_PERSON object, as a result of a few unique objects being rendered through this pipeline."))),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The structure ",(0,i.kt)("inlineCode",{parentName:"p"},"SpriteFrameEvent")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"OnAnimSpriteFrame")," event is subject to heavy API changes in future Multiverse updates."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=hp_bars_example.lua",title:"hp_bars_example.lua"},'function OnAnimSpriteFrame(frame)\n    if (frame.Thing.Type == T_PERSON) then\n        if (frame.Thing.Model == M_PERSON_MEDICINE_MAN) then\n            local life = frame.Thing.u.Pers.Life\n            local bar_w, bar_h = 100, 8\n            local x, y = frame.x - (bar_w / 2), frame.y - frame.h - 10\n            DrawBox(x, y, bar_w+2, bar_h+2, COLOUR(CLR_BLACK))\n            DrawBox(x, y, bar_w, bar_h, COLOUR(CLR_BLACK))\n            local life_bar_w = math.floor((bar_w * (life)) / frame.Thing.u.Pers.MaxLife)\n            if (life > 0) then DrawBox(x, y, life_bar_w, bar_h, COLOUR(CLR_RED)) end \n            local life_str = string.format("%i / %i", life, frame.Thing.u.Pers.MaxLife)\n            PopSetFont(P3_SMALL_FONT_NORMAL, 0)\n            DrawTextStr(math.floor((x - (string_width(life_str) / 2)) + (bar_w / 2)), y, life_str)\n        end\n    end\nend\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Result")),(0,i.kt)("img",{src:a(6154).Z}),(0,i.kt)("hr",null),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("h2",{id:"other-"},(0,i.kt)("ins",null,"Other")," \u2728"),(0,i.kt)("h3",{id:"onplayerhintdisplay"},"OnPlayerHintDisplay"),(0,i.kt)("p",null,"This event will trigger when a hint is being displayed by the game. See ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#playerhintdisplay"},"PlayerHintDisplay"))," for more details.."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Hint example."),(0,i.kt)("img",{src:a(9638).Z})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#playerhintdisplay"},"PlayerHintDisplay*"))),(0,i.kt)("td",{parentName:"tr",align:null},"hint"),(0,i.kt)("td",{parentName:"tr",align:null},"This is a data structure containing information about the hint.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},'function OnPlayerHintDisplay(hint)\n    Log(string.format("Hint StrId: %i, hint.StrId))\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onplayerspell"},"OnPlayerSpell"),(0,i.kt)("p",null,"This event will trigger when a spell is being cast. It is similar to the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"#onthing"},"OnThing"))," event, but you're guaranteed to only parse spells."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#thing"},"Thing*"))),(0,i.kt)("td",{parentName:"tr",align:null},"thing"),(0,i.kt)("td",{parentName:"tr",align:null},"The spell object.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The thing object is passed by reference, so you may modify the object inside the callback function."))),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"If you're only interested in parsing spells, ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"#onplayerspell"},"OnPlayerSpell"))," will be a better alternative to ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"#onthing"},"OnThing")),", since you won't be having to parse hundreds of objects."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},"function OnPlayerSpell(thing) \n    if (thing.Owner == TRIBE_BLUE) then\n        thing.Model = M_SPELL_FIRESTORM\n    end\nend\n")),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"ondamage"},"OnDamage"),(0,i.kt)("p",null,"This event will trigger when a person receives damage. Visit this page for more information about the DamageEvent structure."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-structs#damageevent"},"DamageEvent"))),(0,i.kt)("td",{parentName:"tr",align:null},"event"),(0,i.kt)("td",{parentName:"tr",align:null},"The damage event, this being a data structure.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Not all damage sources will trigger this event."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=example.lua",title:"example.lua"},"function OnDamage(event)\n    if (event.DamagingPlayer == TRIBE_RED) then\n        event.Thing.u.Pers.Life = event.Thing.u.Pers.Life + math.floor(event.Damage * 2) -- heal the person\n    end\nend\n")),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"ondeinit"},"OnDeinit"),(0,i.kt)("p",null,"This event will trigger when a script is being removed, i.e script is no longer active."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters"),"\nNone."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This event gives you the opportunity to clean up after yourself."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Example"),"\nNone."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onloadpaltables"},"OnLoadPalTables"),(0,i.kt)("p",null,"This event will trigger when the game generates the ",(0,i.kt)("inlineCode",{parentName:"p"},"ghost")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"fade")," color tables."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#ubyte"},"UBYTE"))),(0,i.kt)("td",{parentName:"tr",align:null},"level"),(0,i.kt)("td",{parentName:"tr",align:null},"Current level being played.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This event might become deprecated as there's no use for it any longer."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Examples"),"\nNone."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onfrontend"},"OnFrontEnd"),(0,i.kt)("p",null,"This event will trigger every time the user goes back into the main menu screen. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters"),"\nNone."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The event can only be called by a ",(0,i.kt)("inlineCode",{parentName:"p"},"Parent")," script."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=main.lua",title:"main.lua"},'function OnFrontEnd()\n    Log("User has entered the front end menu!")\nend\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onframecredits"},"OnFrameCredits"),(0,i.kt)("p",null,"It is expected of you to return a ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"../mv-api/mv-types#bool"},"boolean")),", indicating whether you want the game to draw the original scrolling credits text. Returning a ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," value will tell the game ",(0,i.kt)("strong",{parentName:"p"},"not")," to draw the credits text."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters"),"\nNone."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Notes")),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The event can only be called by a ",(0,i.kt)("inlineCode",{parentName:"p"},"Parent")," script."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=main.lua",title:"main.lua"},"function OnFrameCredits()\n    -- Draw a red background\n    DrawBox(0,0,800,600,COLOUR(CLR_RED))\n    return true\nend\n")),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"onfrontendframe"},"OnFrontEndFrame"),(0,i.kt)("p",null,"Called every frame whilst inside front end menus. For example, main menu, level select menu, in-game pause menu, etc."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Parameters"),"\nNone."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-lua",metastring:"title=main.lua",title:"main.lua"},"function OnFrontEndFrame()\n    -- Draw a red background\n    DrawBox(0,0,800,600,COLOUR(CLR_RED))\nend\n")),(0,i.kt)("hr",null))}u.isMDXComponent=!0},6154:function(e,t,a){t.Z=a.p+"assets/images/hp-bars-3d9c42a7b5da90d0f9d943b4c227b99b.gif"},9638:function(e,t,a){t.Z=a.p+"assets/images/playerhint-ecf998946eb54643d099820c9548ff87.png"}}]);